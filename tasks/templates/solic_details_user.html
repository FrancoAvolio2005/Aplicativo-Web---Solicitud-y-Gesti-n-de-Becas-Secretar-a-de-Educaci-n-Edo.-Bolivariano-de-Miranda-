<!-- Este c贸digo es una plantilla de Django que genera la p谩gina de "Detalles de la Solicitud". Su prop贸sito es mostrar de forma organizada y visualmente clara
toda la informaci贸n que un usuario envi贸 previamente en un formulario de solicitud de beca.

Utiliza la estructura de plantillas de Django para acceder a los datos del objeto solicitud y el framework Bootstrap para el dise帽o, en particular para las tarjetas
(card), el sistema de columnas (row, col), y los distintivos de estado (badge). -->

{% extends 'base.html' %}
{% load static %}
{% block content %}

<!-- Datos de la Solicitud
Muestra informaci贸n general sobre el proceso de solicitud.

Campo	Valor Obtenido	Descripci贸n:

Nombre del Usuario Solicitante	(solicitud.user.get_full_name)	El nombre completo del usuario que cre贸 la solicitud.

Correo Electr贸nico	(solicitud.user.email)	El correo del usuario.

Beca Solicitada	(solicitud.beca.nombre)	El nombre del tipo de beca que se est谩 solicitando.

Estatus de la Beca	(solicitud.estatus_beca.nombre)	El estado actual de la solicitud (Aprobada, Rechazado, u otro).

Fecha de Solicitud	(solicitud.fecha_creacion	date:"d M Y H:i") -->

<main class="container py-4">
    <div class="row">
        <div class="col-md-10 offset-md-1">
            <h2 class="display-6 text-center mb-4">Detalles de la Solicitud</h2>
            <hr class="mb-5">

            <div class="card shadow-lg p-4 mb-5 border-0 rounded-4">
                <div class="card-body">

                    <div class="mb-5">
                        <h4 class="mb-3 border-bottom pb-2">Datos de la Solicitud</h4>
                        <div class="row row-cols-1 row-cols-md-2 g-3 mb-4">
                            <div class="col">
                                <strong>Nombre del Usuario Solicitante:</strong> {{ solicitud.user.get_full_name|default:solicitud.user.username }}
                            </div>
                            <div class="col">
                                <strong>Correo Electr贸nico:</strong> {{ solicitud.user.email }}
                            </div>
                            <div class="col">
                                <strong>Beca Solicitada:</strong> {{ solicitud.beca.nombre|default:"No especificada" }}
                            </div>

                            <!-- L贸gica de Estatus: Utiliza etiquetas condicionales (if ) para mostrar el estado con un color distintivo de Bootstrap:

                                Verde (bg-success): Si el estado es 'Aprobada'.

                                Rojo (bg-danger): Si el estado es 'Rechazado'.

                                Amarillo (bg-warning): Si el estado es 'En proceso', que indica que est谩 en revisi贸n. -->

                            <div class="col">
                                <strong>Estatus de la Beca:</strong>
                                {% if solicitud.estatus_beca.nombre == 'Aprobada' %}
                                    <span class="badge bg-primary text-white fs-6">{{ solicitud.estatus_beca.nombre|default:"Desconocido" }}</span>
                                {% elif solicitud.estatus_beca.nombre == 'Rechazada' and solicitud.motivo_rechazo %}
                                <span class="badge bg-danger text-white fs-6">{{ solicitud.estatus_beca.nombre|default:"Desconocido" }}</span>
                                <div class="col-12">
                                    <p class="alert alert-danger mt-3 mb-0 p-3 border-5 border-start border-danger" style="border-left-width: 5px !important;">
                                        <strong> Solicitud Rechazada:</strong> Aqu铆 tienes el motivo de la decisi贸n para que puedas corregir tu postulaci贸n:
                                        <br>
                                        <span class="d-block mt-2 pt-2 border-top border-danger">{{ solicitud.motivo_rechazo }}</span>
                                    </p>
                                </div>
                                {% else %}
                                    <span class="badge bg-warning text-dark fs-6">{{ solicitud.estatus_beca.nombre|default:"Desconocido" }}</span>
                                {% endif %}
                            </div>
                            <div class="col-12">
                                <strong>Fecha de Solicitud:</strong> {{ solicitud.fecha_creacion|date:"d M Y H:i" }}
                            </div>
                        </div>
                    </div>

                    <hr class="my-5">

                    <!-- Se utiliza el filtro |default:"N/A" para asegurar que si un campo est谩 vac铆o, se muestre "N/A" en lugar de quedar en blanco. -->

                    <div class="mb-5">
                        <h4 class="mb-3 border-bottom pb-2">Datos del Estudiante</h4>
                        <div class="row row-cols-1 row-cols-md-2 g-3 mb-4">
                            <div class="col">
                                <strong>Nombre:</strong> {{ solicitud.nombre_becario|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>Apellido:</strong> {{ solicitud.apellido_becario|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>C茅dula:</strong> {{ solicitud.cedula_becario|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>Fecha de Nacimiento:</strong> {{ solicitud.fecha_nacimiento_becario|date:"d M Y"|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>Nacionalidad:</strong> {{ solicitud.nacionalidad_becario|default:"N/A" }}
                            </div>
                            <div class="col-12">
                                <strong>Direcci贸n Residencial:</strong> {{ solicitud.direccion_residencial_becario|default:"N/A" }}
                            </div>
                        </div>
                    </div>

                    <hr class="my-5">

                    <div class="mb-5">
                        <h4 class="mb-3 border-bottom pb-2">Ubicaci贸n y Plantel</h4>
                        <div class="row row-cols-1 row-cols-md-3 g-3 mb-4">
                            <div class="col">
                                <strong>Estado:</strong> {{ solicitud.estado.nombre|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>Municipio:</strong> {{ solicitud.municipio.nombre|default:"N/A" }}
                            </div>
                            <div class="col">
                                <strong>Parroquia:</strong> {{ solicitud.parroquia.nombre|default:"N/A" }}
                            </div>
                            <div class="col-12">
                                <strong>Instituci贸n Educativa:</strong> {{ solicitud.plantel.nombre_plantel|default:"N/A" }}
                            </div>
                        </div>
                    </div>

                    <hr class="my-5">

                    <div class="mb-5">
                        <h4 class="mb-3 border-bottom pb-2">Informaci贸n Bancaria</h4>
                        <div class="row row-cols-1 row-cols-md-2 g-3 mb-4"> 
                            <div class="col">
                                <strong>Banco:</strong> {{ solicitud.banco.nombre|default:"No especificado" }}
                            </div>
                            <div class="col">
                                <strong>N煤mero de Cuenta:</strong> {{ solicitud.numero_de_cuenta|default:"No proporcionado" }}
                            </div>
                        </div>
                    </div>

                    <hr class="my-5">

                    <!-- Esta es una secci贸n cr铆tica que presenta los archivos subidos en un formato de tabla responsiva (table-responsive).

                        Tipo de Documento:	Nombre del documento requerido (Constancia de Estudios, C茅dula, etc.).
                        Estado:	Usa badges para indicar si el documento est谩 "Adjunto" (Amarillo) o "Falta" (Rojo).
                        Visualizar:	Muestra un bot贸n "Ver" que enlaza a la URL del archivo (<a href="{{ solicitud.campo_archivo.url }}" target="_blank">) si el archivo existe. Si no, muestra "N/A".
                        Miniatura:	Muestra una mini imagen (<img src="...">) del documento si est谩 adjunto. Esto es 煤til para una revisi贸n r谩pida sin tener que hacer clic en el enlace. -->

                    <div class="mb-5">
                        <h4 class="mb-3 border-bottom pb-2">Documentos Adjuntos</h4> 
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th scope="col">Tipo de Documento</th>
                                        <th scope="col" class="text-center">Estado</th>
                                        <th scope="col" class="text-center">Visualizar</th>
                                        <th scope="col" class="text-center">Miniatura</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Constancia de Estudios</td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_estudios %}<span class="badge bg-warning text-dark">Adjunto</span>{% else %}<span class="badge bg-danger">Falta</span>{% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_estudios %}
                                                <a href="{{ solicitud.constancia_estudios.url }}" target="_blank" class="btn btn-outline-primary btn-sm">Ver</a>
                                            {% else %}
                                                N/A
                                            {% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_estudios %}
                                                <img src="{{ solicitud.constancia_estudios.url }}" alt="Constancia" class="img-fluid rounded" style="max-height: 80px; object-fit: contain;">
                                            {% else %}
                                                -
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Constancia de N煤mero de Cuenta Bancaria</td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_numero_cuenta %}<span class="badge bg-warning text-dark">Adjunto</span>{% else %}<span class="badge bg-danger">Falta</span>{% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_numero_cuenta %}
                                                <a href="{{ solicitud.constancia_numero_cuenta.url }}" target="_blank" class="btn btn-outline-primary btn-sm">Ver</a>
                                            {% else %}
                                                N/A
                                            {% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.constancia_numero_cuenta %}
                                                <img src="{{ solicitud.constancia_numero_cuenta.url }}" alt="Constancia" class="img-fluid rounded" style="max-height: 80px; object-fit: contain;">
                                            {% else %}
                                                -
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Bolet铆n</td>
                                        <td class="text-center">
                                            {% if solicitud.boletin %}<span class="badge bg-warning text-dark">Adjunto</span>{% else %}<span class="badge bg-danger">Falta</span>{% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.boletin %}
                                                <a href="{{ solicitud.boletin.url }}" target="_blank" class="btn btn-outline-primary btn-sm">Ver</a>
                                            {% else %}
                                                N/A
                                            {% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.boletin %}
                                                <img src="{{ solicitud.boletin.url }}" alt="Bolet铆n" class="img-fluid rounded" style="max-height: 80px; object-fit: contain;">
                                            {% else %}
                                                -
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>C茅dula de Identidad</td>
                                        <td class="text-center">
                                            {% if solicitud.cedula %}<span class="badge bg-warning text-dark">Adjunto</span>{% else %}<span class="badge bg-danger">Falta</span>{% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.cedula %}
                                                <a href="{{ solicitud.cedula.url }}" target="_blank" class="btn btn-outline-primary btn-sm">Ver</a>
                                            {% else %}
                                                N/A
                                            {% endif %}
                                        </td>
                                        <td class="text-center">
                                            {% if solicitud.cedula %}
                                                <img src="{{ solicitud.cedula.url }}" alt="C茅dula" class="img-fluid rounded" style="max-height: 80px; object-fit: contain;">
                                            {% else %}
                                                -
                                            {% endif %}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div> 
            </div>

            <!-- Bot贸n "Volver atr谩s": Permite al usuario regresar a la p谩gina anterior utilizando c贸digo JavaScript (javascript:history.back()).

            Condici贸n de Usuario: El bot贸n solo se muestra si el usuario NO es un superusuario (if not user.is_superuser) -->

            <div class="d-flex justify-content-between align-items-center mt-4 mb-5">
                {% if not user.is_superuser %}
                    <a href="javascript:history.back()" class="btn btn-danger btn-lg">
                        <ion-icon name="arrow-back-outline" class="ms-2 align-middle" style="font-size: 1.3rem;"></ion-icon> Volver atr谩s
                    </a>
                {% endif %}
            </div>

        </div>
    </div>
</main>

{% endblock %}